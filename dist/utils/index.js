var kefir=require("kefir");module.exports={ajax:function e(t,n){function o(e){u=e,c=e.readyState,a=e.status,i&&r(i)}function r(e){if(c<4)return void(i=e);a>=200&&(a>=300?e.rejected({statusText:f.statusText,statusCode:a}):e.resolved(f.responseText))}if(!(this instanceof e))return new e(t,n);var i,a,u,s=n.params?this.serialize(n.params):null,c=0;this.then=function(e,t){r({resolved:e,rejected:t||this.defaultError})}.bind(this),this.defaultError=function(e){console.warn("404: Bad request.")};var f=window.XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP");f.onreadystatechange=function(){o(f)},f.open(t.toUpperCase(),n.url,!0),f.setRequestHeader("Content-type","application/x-www-form-urlencoded"),f.send(s)},compareTo:function(e,t){return JSON.stringify(e)===JSON.stringify(t)},each:function(e,t){for(var n=0;n<e.length&&!t(e[n],n++););},emit:function(e,t){return kefir.stream(function(t){return t.emit(e)})},emitWhile:function(e,t){return this.emit(e).takeWhile(t)},extend:function(e,t){for(var n in t)e[n]=t[n]},extendMany:function(){return[].slice.call(arguments).reduce(function(e,t){for(var n in t)e[n]=t[n];return e},{})},serialize:{form:function(e){var t,n=[];if("object"==typeof e&&"FORM"==e.nodeName){var o=e.elements.length;for(i=0;i<o;i++)if(t=e.elements[i],t.name&&!t.disabled&&"file"!=t.type&&"reset"!=t.type&&"submit"!=t.type&&"button"!=t.type)if("select-multiple"==t.type)for(j=e.elements[i].options.length-1;j>=0;j--)t.options[j].selected&&(n[n.length]=encodeURIComponent(t.name)+"="+encodeURIComponent(t.options[j].value));else("checkbox"!=t.type&&"radio"!=t.type||t.checked)&&(n[n.length]=encodeURIComponent(t.name)+"="+encodeURIComponent(t.value))}return n.join("&").replace(/%20/g,"+")},object:function(e){var t=[];for(var n in e)e.hasOwnProperty(n)&&t.push(encodeURIComponent(n)+"="+encodeURIComponent(e[n]));return t.join("&")}},Singleton:function(e){return function(){var t;return{getInstance:function(n){return t||(t=new e(n)),t}}}()},thennable:function(e){return Boolean(e.then)}};